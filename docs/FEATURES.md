# 📊 주요 기능 및 알고리즘 상세 (Features & Algorithms)

KR Market Package의 핵심 기능과 작동 원리에 대한 상세 설명입니다.

## 1. Market Gate (시장 상태)

### 개요
KOSPI 지수의 등락률과 수급을 기반으로 시장의 전반적인 상태(강세/약세)를 판단합니다.

### 상태 판단 로직
- **BULLISH (강세)**: KOSPI +1.0% 이상 & 외국인 순매수
- **BEARISH (약세)**: KOSPI -1.0% 이하
- **NEUTRAL (중립)**: 그 외

### 데이터 갱신
- 실시간(장중): 10분 단위 갱신 (네이버 금융 크롤링)
- 종가(장마감): 당일 종가 기준 확정

---

## 2. VCP Signals (변동성 수축 패턴)

### 개요
Mark Minervini의 **VCP(Volatility Contraction Pattern)** 전략을 기반으로, 변동성이 줄어들며 수급이 몰리는 종목을 포착합니다.

### 시그널 조건
1. **점수 (Score)**: 60점 이상 (100점 만점)
   - 외국인/기관 수급 집중도
   - 거래량 감소 패턴
2. **수축 비율 (Contraction Ratio)**: 0.8 이하 (낮을수록 좋음)
   - 고점 대비 저점의 폭이 점차 줄어드는지 확인

### 활용법
- `signals_log.csv`에 기록된 종목 중 상위 랭크 종목을 관심 종목에 등록.
- 장중 돌파 매매 시 참고.

---

## 3. Closing Bet V2 (종가 베팅)

### 개요
장 마감 직전(3시 20분경)에 매수하여 다음 날 시가 갭상승을 노리는 전략입니다. **12점 만점 시스템**으로 엄격하게 필터링합니다.

### 12점 평가 시스템 (`scorer.py`)
|  평가 항목   | 배점  | 기준                                  |
| :----------: | :---: | ------------------------------------- |
|   **뉴스**   |  3점  | 호재성 뉴스 유무 및 강도 (AI 분석)    |
| **거래대금** |  3점  | 1조원↑(3점), 5천억↑(2점), 1천억↑(1점) |
|   **차트**   |  2점  | 신고가, 정배열, 지지선 확인           |
|   **수급**   |  2점  | 외국인/기관 양매수 여부               |
|   **캔들**   |  1점  | 윗꼬리 없는 장대양봉 선호             |
|   **조정**   |  1점  | 기간 조정 후 재돌파                   |

### 등급 기준
- **S급 (강력 추천)**: 10점 이상 + 거래대금 1조원 이상
- **A급 (추천)**: 8점 이상 + 거래대금 5천억원 이상
- **B급 (관심)**: 6점 이상 + 거래대금 1천억원 이상
- **C급 (보류)**: 기준 미달

### 데이터 업데이트
- 매일 장 마감 후 `jongga_v2_latest.json` 파일 갱신.

---

## 4. AI Analysis

### 개요
Google Gemini와 OpenAI GPT 모델을 사용하여 종목의 뉴스, 수급, 차트를 종합 분석하고 매매 의견을 제시합니다.

### 분석 결과
- **Recommendation**: BUY / HOLD / SELL
- **Confidence**: 신뢰도 점수 (0~100)
- **Reason**: 분석 근거 요약
